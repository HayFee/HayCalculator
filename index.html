<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HayCalculator</title>
  </head>

  <body>
    <p id="text-display" class="text-display">#####</p>
    <button class="button-number" onclick="buttonHandler(this)">1</button>
    <button class="button-number" onclick="buttonHandler(this)">2</button>
    <button class="button-number" onclick="buttonHandler(this)">3</button>
    <br />
    <button class="button-number" onclick="buttonHandler(this)">4</button>
    <button class="button-number" onclick="buttonHandler(this)">5</button>
    <button class="button-number" onclick="buttonHandler(this)">6</button>
    <br />
    <button class="button-number" onclick="buttonHandler(this)">7</button>
    <button class="button-number" onclick="buttonHandler(this)">8</button>
    <button class="button-number" onclick="buttonHandler(this)">9</button>
    <br />
    <button class="button-number" onclick="buttonHandler(this)">.</button>
    <button class="button-number" onclick="buttonHandler(this)">0</button>
    <button class="button-operator" onclick="buttonHandler(this)">=</button>
    <br />
    <button class="button-operator" onclick="buttonHandler(this)">+</button>
    <button class="button-operator" onclick="buttonHandler(this)">-</button>
    <button class="button-operator" onclick="buttonHandler(this)">*</button>
    <button class="button-operator" onclick="buttonHandler(this)">/</button>
    <br />
    <button class="button-clear" onclick="buttonHandler(this)">AC</button>
    <button class="button-clear" onclick="buttonHandler(this)">C</button>
  </body>

  <script>
    const memory = [];
    let num = "";
    let operator = "";

    function buttonHandler(value) {
      if (
        value.className === "button-number" ||
        (value.innerHTML === "." && !num.includes("."))
      ) {
        if (operator != "") {
          memory.push(operator);
          clearOperator();
        }

        if (value.innerHTML === "0" && num === "0") {
          return null;
        }

        num = num + value.innerHTML; // concatenate to number string
      } else if (value.className === "button-operator") {
        if (num.length != 0) {
          memory.push(Number(num));
          clearNum();
        }
        operator = value.innerHTML;

        if (operator == "=") {
          updateDisplay(evalMemory());
        }
      } else {
        // clears
        if (value.innerHTML === "AC") {
          clearAC();
        } else {
          clearC();
        }
      }
    }

    //TODO
    function evalMemory() {
      return eval(memory.join(""));
    }

    function updateDisplay(value = 0) {
      document.getElementById("text-display").textContent = value;
    }

    function clearNum() {
      num = "";
    }

    function clearOperator() {
      operator = "";
    }

    function clearC() {
      memory.pop();
    }

    function clearAC() {
      while (memory.length > 0) {
        memory.pop();
      }
      clearNum();
      clearOperator();
      updateDisplay();
    }
  </script>
</html>
